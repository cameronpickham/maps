// Generated by CoffeeScript 1.6.3
(function() {
  var initialize, makeMap, map, places, plot;

  map = null;

  places = [];

  $.getJSON("./checkins.json", function(data) {
    places = data;
    return makeMap();
  });

  makeMap = function() {
    return google.maps.event.addDomListener(window, "load", initialize());
  };

  initialize = function() {
    var mapOptions, place, _i, _len, _results;
    mapOptions = {
      zoom: 12,
      center: new google.maps.LatLng(34.02234, -118.28512),
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      disableDefaultUI: true
    };
    map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
    _results = [];
    for (_i = 0, _len = places.length; _i < _len; _i++) {
      place = places[_i];
      _results.push(plot(place, map));
    }
    return _results;
  };

  plot = function(place, map) {
    var info_window, latLng, marker;
    latLng = place.latLng;
    info_window = new google.maps.InfoWindow({
      content: "" + place.name + ": " + place.count
    });
    marker = new google.maps.Marker({
      map: map,
      position: new google.maps.LatLng(latLng[0], latLng[1])
    });
    google.maps.event.addListener(marker, 'mouseover', function() {
      return info_window.open(map, marker);
    });
    return google.maps.event.addListener(marker, 'mouseout', function() {
      return info_window.close();
    });
  };

  $("#list").click(function() {
    return $("#menu").collapse('toggle');
  });

  $(".recent").click(function(event) {
    var clickedId, ele, latLng, vals;
    clickedId = $(this).attr("id").substring(3);
    ele = $("body").find('#' + "input-" + clickedId);
    vals = ele.val().split(/[, ]+/);
    latLng = vals.map(function(v) {
      return parseFloat(v);
    });
    map.setCenter(new google.maps.LatLng(latLng[0], latLng[1]));
    return $("#menu").collapse('toggle');
  });

  $("#close").click(function() {
    return $("#menu").collapse('toggle');
  });

}).call(this);
